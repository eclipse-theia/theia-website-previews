{"componentChunkName":"component---src-templates-doc-js","path":"/docs/services_and_contributions","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Services and Contributions"},"html":"<h1 id=\"services-and-contributions\" style=\"position:relative;\"><a href=\"#services-and-contributions\" aria-label=\"services and contributions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Services and Contributions</h1>\n<p>In this section we describe how <a href=\"/theia-website-previews/pr-previews/pr-602/docs/extensions#theia-extensions\">Theia extensions</a> can use services provided by the platform and by other extensions. Furthermore, we describe how extensions can contribute to the Theia workbench via contribution points.</p>\n<p>A <strong>service</strong> is an object that provides functionality to its consumers. The contract between a service and its consumers is described by an interface. Any implementation of a service must implement that interface according to the interface documentation. Any extension in Theia can provide and/or consume services. The extensions provided by the Theia platform provide a set of default services, e.g. the <a href=\"/theia-website-previews/pr-previews/pr-602/docs/message_service/\"><code class=\"language-text\">MessageService</code></a>. However, you can provide and consume your own custom services, too.</p>\n<p><strong>Contribution points</strong> define hooks, which allow extending something. Contribution points are defined by an interface that the contributor is expected to implement, e.g. a <code class=\"language-text\">CommandContribution</code>. The extension defining the contribution point will then pick up the contribution, e.g. adding the contributed command to the Theia workbench.</p>\n<p>Contribution points, like services, can be contributed to and defined by any extension. The Theia platform defines a set of default contribution points, e.g. to add commands or menus to the Theia workbench. However, you can also define your own ones.</p>\n<p>The usage of services and contribution points requires communication between extensions. To avoid direct dependencies on the implementation classes, Theia uses dependency injection.</p>\n<img src=\"../../dependency-injection.png\" alt=\"Dependency Injection Overview\" style=\"max-width: 525px\">\n<p>In the following sections, we provide a quick overview of dependency injection, services, contributions and how to define contribution points.</p>\n<h2 id=\"dependency-injection-di\" style=\"position:relative;\"><a href=\"#dependency-injection-di\" aria-label=\"dependency injection di permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Dependency Injection (DI)</h2>\n<p>Theia uses the DI framework <a href=\"http://inversify.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">InversifyJS</a> to wire ups the difference services and contributions points.</p>\n<p>Dependency injection decouples the consumers of services -- i.e. the dependencies of those consumers -- from the actual creation and retrieval of those services. As an example, if you want to use a service, you neither have to instantiate it, nor do you need to manually retrieve it from somewhere. Instead, the dependency injection container injects the services on creation of your component. The dependency injection container resolves the dependency for you and, if necessary, even instantiates it on the fly. With that, the consumer of services doesn’t need to worry where they come from. You can easily exchange the actual implementations of services later on without having to change the consumers. The dependency injection container works based on some configuration you provide on startup through so-called container modules.</p>\n<p>We will provide examples on how to use dependency injection in the sections “Services” and “Contributing to contribution points” below.</p>\n<p>Dependency injection is an integral part of Theia. Therefore, we highly recommend learning at\nleast the basics of <a href=\"http://inversify.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">InversifyJS</a>. For more details, please also refer to <a href=\"https://eclipsesource.com/blogs/2018/11/28/how-to-inversify-in-eclipse-theia/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">this article on how dependency injection works in Theia</a></p>\n<h2 id=\"using-services\" style=\"position:relative;\"><a href=\"#using-services\" aria-label=\"using services permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using Services</h2>\n<p>To use a service in Theia, you can get it injected as a dependency using DI. Dependencies are usually specified via the interface of the service you want to retrieve. This way, you even avoid a dependency on any specific implementation, the caller just knows the interface. This allows the component providing the implementation to seamlessly replace the implementation of a service. You can even override the existing default implementation of a service without breaking any service consumers.</p>\n<p>To get a parameter injected from the dependency injection container, you need to annotate it with an identifier (a string). Service providers on the other hand will publish the available services using an identifier, too. When a parameter with a specific identifier is requested via dependency injection, the dependency injection context will look it up and return an instance of the respective service. For convenience service providers usually use a Symbol as an identifier that has exactly the same name as the respective service interface itself. The following examples the '@inject(MessageService)' is the symbol (service identifier), while 'private readonly messageService: MessageService' is referring the interface of the service.</p>\n<p>Services, or more generically, dependencies can be injected as fields, in the constructor or in initialization functions (see following code example).</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// Injection in the constructor.</span>\n<span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">@<span class=\"token function\">inject</span><span class=\"token punctuation\">(</span>MessageService<span class=\"token punctuation\">)</span> <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> messageService<span class=\"token operator\">:</span> MessageService</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Injection as a field.</span>\n@<span class=\"token function\">inject</span><span class=\"token punctuation\">(</span>MessageService<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">protected</span> <span class=\"token keyword\">readonly</span> messageService<span class=\"token operator\">!</span><span class=\"token operator\">:</span> MessageService<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Injection in an initialization function (will be called after the constructor and after injecting fields.</span>\n@<span class=\"token function\">postConstruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">protected</span> <span class=\"token keyword\">async</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">@<span class=\"token function\">inject</span><span class=\"token punctuation\">(</span>MessageService<span class=\"token punctuation\">)</span> <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> messageService<span class=\"token operator\">:</span> MessageService</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Please note that injection will only work in components that are created by the DI container. Therefore, they must be marked with <code class=\"language-text\">@injectable</code> (see code example below). Furthermore, they must be registered in the DI context (for an example see next section).</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">@<span class=\"token function\">injectable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyContribution</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">SomeContributionInterface</span></code></pre></div>\n<h2 id=\"contributing-to-contribution-points\" style=\"position:relative;\"><a href=\"#contributing-to-contribution-points\" aria-label=\"contributing to contribution points permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Contributing to Contribution Points</h2>\n<p>Contribution Points in Theia define an interface to be implemented, e.g. <code class=\"language-text\">CommandContribution</code>. A contributing extension must provide an implementation of this interface and mark it with <code class=\"language-text\">@injectable</code>, e.g.:</p>\n<p><strong>mycommand-contribution.ts</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">@<span class=\"token function\">injectable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyCommandContribution</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">CommandContribution</span></code></pre></div>\n<p>Additionally, the contribution must be bound in the DI container, so that the contribution point provider can pick up our contribution, more precisely get it injected. The binding is done in the container module of an extension. It binds the implementation to the contribution interface, or to be technically correct, to the Symbol representing the interface (see example below).</p>\n<p><strong>helloworld-frontend-module.ts</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ContainerModule</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">bind</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n   <span class=\"token comment\">// add your contribution bindings here</span>\n   <span class=\"token function\">bind</span><span class=\"token punctuation\">(</span>CommandContribution<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>HelloworldCommandContribution<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Please see <a href=\"/theia-website-previews/pr-previews/pr-602/docs/commands_keybindings/\">Commands/Menus/Keybindings</a> for a simple example for the usage of services and contribution points.</p>\n<h2 id=\"defining-contribution-points\" style=\"position:relative;\"><a href=\"#defining-contribution-points\" aria-label=\"defining contribution points permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Defining Contribution-Points</h2>\n<p>If an extension wants to provide a hook for others to contribute to, they\nshould define a <em>contribution-point</em>. A <em>contribution-point</em> is just an\ninterface that many others can implement. The extension will delegate to them\nwhen needed.</p>\n<p>The <code class=\"language-text\">OpenerService</code>, for instance, defines a contribution point to allow others\nregistering <code class=\"language-text\">OpenHandler</code>s. You can have a look at the code\n<a href=\"https://github.com/eclipse-theia/theia/blob/master/packages/core/src/browser/opener-service.ts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">here</a>.</p>\n<p>Theia comes with an extensive list of contribution points already. A good way\nto see what contribution points exist is to do a find references on\n<code class=\"language-text\">bindContributionProvider</code>.</p>\n<h2 id=\"contribution-providers\" style=\"position:relative;\"><a href=\"#contribution-providers\" aria-label=\"contribution providers permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Contribution Providers</h2>\n<p>A contribution provider is basically a container for contributions where\ncontributions are instances of a bound type.</p>\n<p>It is very generic.</p>\n<p>To bind a type to a contribution provider you can do like this:</p>\n<p>(From messaging-module.ts)</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> messagingModule <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ContainerModule</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">bind</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    bind<span class=\"token operator\">&lt;</span>BackendApplicationContribution<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>BackendApplicationContribution<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">to</span><span class=\"token punctuation\">(</span>MessagingContribution<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">bindContributionProvider</span><span class=\"token punctuation\">(</span>bind<span class=\"token punctuation\">,</span> ConnectionHandler<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The last line will bind a ContributionProvider to one that contains all\nConnectionHandler bound instances.</p>\n<p>It is used as such:</p>\n<p>(From messaging-module.ts)</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">    <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span> <span class=\"token parameter\">@<span class=\"token function\">inject</span><span class=\"token punctuation\">(</span>ContributionProvider<span class=\"token punctuation\">)</span> @<span class=\"token function\">named</span><span class=\"token punctuation\">(</span>ConnectionHandler<span class=\"token punctuation\">)</span> <span class=\"token keyword\">protected</span> <span class=\"token keyword\">readonly</span> handlers<span class=\"token operator\">:</span> ContributionProvider<span class=\"token operator\">&lt;</span>ConnectionHandler<span class=\"token operator\">></span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p>So here we're injecting a ContributionProvider with the named\nConnectionHandler value that was bound before by <code class=\"language-text\">bindContributionProvider</code>.</p>\n<p>This enables anyone to bind a ConnectionHandler and now when the\nmessagingModule is started all the ConnectionHandlers will be initiated.</p>","fields":{"slug":"services_and_contributions"}}},"pageContext":{"slug":"services_and_contributions"}}}